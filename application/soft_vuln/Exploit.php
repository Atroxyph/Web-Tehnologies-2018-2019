<?php

	/**
	 * @author Paul-Reftu
	 */

	require_once("NotAnExploitException.php");
	require_once("NotAnExploitPropException.php");


	/**
	 * class whose instance represents a software vulnerability
	 */
	class Exploit {
		
		/*
		 * ID of the exploit
		 */
		private $id;
		/*
		 * author of the exploit
		 */
		private $author;
		/*
		 * Bugtraq ID of the exploit
		 */
		private $bid;
		/*
		 * the code of the exploit
		 */
		private $code;
		/*
		 * Common Vulnerability and Exposures ID of the exploit
		 */
		private $cve;
		/*
		 * date when the exploit was released
		 */
		private $date;
		/*
		 * description of the exploit
		 */
		private $description;
		/*
		 * Microsoft Security Bulletin ID of the exploit
		 */
		private $msb;
		/*
		 * Open Source Vulnerability Database ID of the exploit
		 */
		private $osvdb;
		/*
		 * the operating system that the exploit targets
		 */
		private $platform;
		/*
		 * the port number of the affected service if the exploit is remote
		 */
		private $port;
		/*
		 * the category of the exploit (dos, exploit, local, remote, shellcode, webapps)
		 */
		private $type;
		/*
		 * where the exploit was found (e.g ExploitDB)
		 */
		private $source;
		

		/**
		 * @param $exploit the exploit object whose information we use
		 *  to construct our Exploit instance
		 * @throws NotAnExploitException
		 * constructs an object of type 'Exploit', taking into account the given information passed on by the given object
		 */
		public function __construct($exploit) {

			if ($exploit === null || !is_object($exploit))
				throw new NotAnExploitException();

			$exploitPropNames = self::getObjectPropNameList();

			foreach ($exploitPropNames as $propName) {
				$this->{$propName} = isset($exploit->{$propName}) ? $exploit->{$propName} : null;
			}

		} // END of __construct()

		/**
		 * @param $propName
		 * returns the value of a specific property identified by the given name
		 * @throws NotAnExploitPropException when an invalid property name is given
		 */
		public function getValueOfProp($propName) {

			if (!in_array($propName, Exploit::getObjectPropNameList()))
				throw new NotAnExploitPropException($propName);

			return $this->{$propName};

		} // END of getValueOfProp()

		/**
		 * @return a list of all property names of an 'Exploit' object
		 */
		public static function getObjectPropNameList() {

			return array("_id", "author", "bid", "code", "cve", "date", "description", "msb", "osvdb", "platform", "port", "type", "source");

		} // END of getObjectPropNameList()

		/**
		 * @return the id
		 */
		public function getId() { return $this->id; }

		/**
		 * @return the author
		 */
		public function getAuthor() { return $this->author; }

		/**
		 * @return the BID
		 */
		public function getBid() { return $this->bid; }

		/**
		 * @return the code
		 */
		public function getCode() { return $this->code; }

		/**
		 * @return the CVE
		 */
		public function getCve() { return $this->cve; }

		/**
		 * @return the date
		 */
		public function getDate() { return $this->date; }

		/**
		 * @return the description
		 */
		public function getDescription() { return $this->description; }

		/**
		 * @return the MSB
		 */
		public function getMsb() { return $this->msb; }

		/**
		 * @return the OSVDB
		 */
		public function getOsvdb() { return $this->osvdb; }

		/**
		 * @return the platform
		 */
		public function getPlatform() { return $this->platform; }

		/**
		 * @return the port
		 */
		public function getPort() { return $this->port; }

		/**
		 * @return the type
		 */
		public function getType() { return $this->type; }

		/**
		 * @return the source
		 */
		public function getSource() { return $this->source; }

		/**
		 * @param $id
		 */
		public function setId($id) { $this->id = $id; }

		/**
		 * @param $author
		 */
		public function setAuthor($author) { $this->author = $author; }

		/**
		 * @param $bid
		 */
		public function setBid($bid) { $this->bid = $bid; }

		/**
		 * @param $code
		 */
		public function setCode($code) { $this->code = $code; }

		/**
		 * @param $cve
		 */
		public function setCve($cve) { $this->cve = $cve; }

		/**
		 * @param $date
		 */
		public function setDate($date) { $this->date = $date; }

		/**
		 * @param $description
		 */
		public function setDescription($description) { $this->description = $description; }

		/**
		 * @param $msb
		 */
		public function setMsb($msb) { $this->msb = $msb; }

		/**
		 * @param $osvdb
		 */
		public function setOsvdb($osvdb) { $this->osvdb = $osvdb; }

		/**
		 * @param $platform
		 */
		public function setPlatform($platform) { $this->platform = $platform; }

		/**
		 * @param $port
		 */
		public function setPort($port) { $this->port = $port; }

		/**
		 * @param $type
		 */
		public function setType($type) { $this->type = $type; }

		/**
		 * @param $source
		 */
		public function setSource($source) { $this->source = $source; }

	}

?>